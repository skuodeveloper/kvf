<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title th:replace="common/base::pagetitle"></title>
    <link th:replace="common/base::static"/>
    <style>

        .layui-carousel-ind {
            position: absolute;
            top: -41px;
            text-align: right;
        }

        .layui-carousel ul.layui-row {
            background: #ffffff;
            margin: 0;
        }

        #shortcut ul.layui-row li {
            text-align: center;
            /*width: 87px;*/
        }

        .layui-carousel ul.layui-row li a i {
            display: inline-block;
            width: 100%;
            height: 60px;
            line-height: 60px;
            text-align: center;
            border-radius: 2px;
            font-size: 30px;
            background-color: #F8F8F8;
            color: #333;
            transition: all .3s;
            -webkit-transition: all .3s;
        }

        .kvf-backlog-body {
            display: block;
            padding: 10px 15px;
            background-color: #f8f8f8;
            color: #999;
            border-radius: 2px;
            transition: all .3s;
            -webkit-transition: all .3s;
        }

        .kvf-backlog-body h3 {
            padding-bottom: 10px;
            font-size: 12px;
        }

        .kvf-backlog-body p cite {
            font-style: normal;
            font-size: 30px;
            font-weight: 300;
            color: #009688;
        }
    </style>
</head>
<body>

<div id="kPage" class="layui-fluid kvf-fluid-padding15">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">快捷方式</div>
                <div class="layui-card-body">

                    <div class="layui-carousel" id="shortcut" lay-indicator="inside">
                        <div carousel-item="">
                            <ul class="layui-row layui-col-space10 layui-this">
                                <li class="layui-col-xs3">
                                    <a lay-href="home/homepage1.html">
                                        <i class="layui-icon layui-icon-console"></i>
                                        <cite>主页一</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="home/homepage2.html">
                                        <i class="layui-icon layui-icon-chart"></i>
                                        <cite>主页二</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="component/layer/list.html">
                                        <i class="layui-icon layui-icon-template-1"></i>
                                        <cite>弹层</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a data-event="im">
                                        <i class="layui-icon layui-icon-chat"></i>
                                        <cite>聊天</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="component/progress/index.html">
                                        <i class="layui-icon layui-icon-find-fill"></i>
                                        <cite>进度条</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="app/workorder/list.html">
                                        <i class="layui-icon layui-icon-survey"></i>
                                        <cite>工单</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="user/user/list.html">
                                        <i class="layui-icon layui-icon-user"></i>
                                        <cite>用户</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/system/website.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>设置</cite>
                                    </a>
                                </li>
                            </ul>
                            <ul class="layui-row layui-col-space10">
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                                <li class="layui-col-xs3">
                                    <a lay-href="set/user/info.html">
                                        <i class="layui-icon layui-icon-set"></i>
                                        <cite>我的资料</cite>
                                    </a>
                                </li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">整体统计</div>
                <div class="layui-card-body">

                    <div class="layui-carousel" id="backlog">
                        <div carousel-item="">
                            <ul class="layui-row layui-col-space10 layui-this">
                                <li class="layui-col-xs6">
                                    <a lay-href="app/content/comment.html" class="kvf-backlog-body">
                                        <h3>注册人数</h3>
                                        <p><cite id="all_zcrs">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a lay-href="app/forum/list.html" class="kvf-backlog-body">
                                        <h3>答题人次</h3>
                                        <p><cite id="all_dtrc">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a lay-href="template/goodslist.html" class="kvf-backlog-body">
                                        <h3>无父邀请码</h3>
                                        <p><cite id="all_wfyqm">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});"
                                       class="kvf-backlog-body">
                                        <h3>无邀请码</h3>
                                        <p><cite id="all_wyqm">0</cite></p>
                                    </a>
                                </li>
                            </ul>
                            <!--<ul class="layui-row layui-col-space10">-->
                            <!--<li class="layui-col-xs6">-->
                            <!--<a href="javascript:;" class="kvf-backlog-body">-->
                            <!--<h3>待审友情链接</h3>-->
                            <!--<p><cite style="color: #FF5722;">5</cite></p>-->
                            <!--</a>-->
                            <!--</li>-->
                            <!--</ul>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">当日统计</div>
                <div class="layui-card-body">

                    <div class="layui-carousel" id="other">
                        <div carousel-item="">
                            <ul class="layui-row layui-col-space10 layui-this">
                                <li class="layui-col-xs6">
                                    <a lay-href="app/content/comment.html" class="kvf-backlog-body">
                                        <h3>注册人数</h3>
                                        <p><cite id="today_zcrs">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a lay-href="app/forum/list.html" class="kvf-backlog-body">
                                        <h3>答题人次</h3>
                                        <p><cite id="today_dtrc">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a lay-href="template/goodslist.html" class="kvf-backlog-body">
                                        <h3>无父邀请码</h3>
                                        <p><cite id="today_wfyqm">0</cite></p>
                                    </a>
                                </li>
                                <li class="layui-col-xs6">
                                    <a href="javascript:;" onclick="layer.tips('不跳转', this, {tips: 3});"
                                       class="kvf-backlog-body">
                                        <h3>无邀请码</h3>
                                        <p><cite id="today_wyqm">0</cite></p>
                                    </a>
                                </li>
                            </ul>
                            <!--<ul class="layui-row layui-col-space10">-->
                            <!--<li class="layui-col-xs6">-->
                            <!--<a href="javascript:;" class="kvf-backlog-body">-->
                            <!--<h3>待审友情链接</h3>-->
                            <!--<p><cite style="color: #FF5722;">5</cite></p>-->
                            <!--</a>-->
                            <!--</li>-->
                            <!--</ul>-->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">折线图</div>
                <div class="layui-card-body">
                    <div id="brokenline" style="width: 100%;height:332px;"></div>
                </div>
            </div>
        </div>
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">饼图</div>
                <div class="layui-card-body">
                    <div id="cpieline" style="width: 100%;height:332px;"></div>
                </div>
            </div>
        </div>
    </div>

</div>


<script th:replace="common/base::context"></script>
<script th:replace="common/base::mainjs"></script>
<script th:replace="common/base::echartjs"></script>

<script type="text/javascript" th:inline="javascript">
    layui.use(['carousel'], function () {
        var $ = layui.$, carousel = layui.carousel;

        carousel.render({
            elem: '#shortcut'
            , width: '100%' //设置容器宽度
            , height: '200px'
            , arrow: 'none' //始终显示箭头
            , autoplay: false
        });
        carousel.render({
            elem: '#backlog'
            , width: '100%' //设置容器宽度
            , height: '200px'
            , arrow: 'none' //始终显示箭头
            , autoplay: false
        });
        carousel.render({
            elem: '#other'
            , width: '100%' //设置容器宽度
            , height: '200px'
            , arrow: 'none' //始终显示箭头
            , autoplay: false
        });

        getAll();
        getToday();

        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('brokenline'));

        // 指定图表的配置项和数据
        var brokenOption = {
            title: {
                text: '近七日'
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['注册人数', '答题人次', '无父邀请码', '无邀请码']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日']
            },
            yAxis: {
                type: 'value'
            },
            series: [
                // {
                //     name:'注册人数',
                //     type:'line',
                //     data:[120, 132, 101, 134, 90, 230, 210]
                // },
                // {
                //     name:'答题人次',
                //     type:'line',
                //     data:[220, 182, 191, 234, 290, 330, 310]
                // },
                // {
                //     name:'无父邀请码',
                //     type:'line',
                //     data:[150, 232, 201, 154, 190, 330, 410]
                // },
                // {
                //     name:'无邀请码',
                //     type:'line',
                //     data:[320, 332, 301, 334, 390, 330, 320]
                // }
            ]
        };

        getJ7r();
        getJ7rDate();

        // 使用刚指定的配置项和数据显示图表。
        // myChart.setOption(brokenOption);

        $(window).resize(function () {
            myChart.resize();
            myChart2.resize();
        });

        var myChart2 = echarts.init(document.getElementById('cpieline'));

        var cpieOption = {
            title: {
                text: '人员类别统计',
                // subtext: '纯属虚构',
                x: 'center'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                type: 'scroll',
                orient: 'vertical',
                right: 10,
                top: 20,
                bottom: 20,
                // data: data.legendData,
                // selected: data.selected
            },
            series: [
                {
                    name: '人员类别',
                    type: 'pie',
                    radius: '55%',
                    center: ['40%', '50%'],
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    },
                    // data: data.seriesData,
                }
            ]
        };

        getPersonType();
        // myChart2.setOption(cpieOption);

        /**
         * 整体统计
         */
        function getAll() {
            $.ajax({
                url: "http://nhmsfz.nhgaj.com/func/home/getAll",
                type: "get",
                dataType: "json",
                success: function (r) {
                    $('#all_zcrs').text(r.data.zcrs);
                    $('#all_dtrc').text(r.data.dtrc);
                    $('#all_wfyqm').text(r.data.wfyqm);
                    $('#all_wyqm').text(r.data.wyqm);
                },
                error: function (data) {
                    alert(JSON.stringify(data));
                }
            });
        }

        /**
         * 今日统计
         */
        function getToday() {
            $.ajax({
                url: "http://nhmsfz.nhgaj.com/func/home/getToday",
                type: "get",
                dataType: "json",
                success: function (r) {
                    $('#today_zcrs').text(r.data.zcrs);
                    $('#today_dtrc').text(r.data.dtrc);
                    $('#today_wfyqm').text(r.data.wfyqm);
                    $('#today_wyqm').text(r.data.wyqm);
                },
                error: function (data) {
                    alert(JSON.stringify(data));
                }
            });
        }

        /**
         * 近七日数据统计
         */
        function getJ7r() {
            $.ajax({
                url: "http://nhmsfz.nhgaj.com/func/home/getLast7days",
                type: "get",
                dataType: "json",
                success: function (r) {
                    brokenOption.series = r.data;
                    myChart.setOption(brokenOption);
                },
                error: function (data) {
                    alert(JSON.stringify(data));
                }
            });
        }

        function getJ7rDate() {
            var dataArr = [];
            for (var i = 0; i < 7; i++) {
                var time = new Date(new Date().setDate(new Date().getDate() + i - 6));
                var month = `0${time.getMonth() + 1}`.slice(-2);
                var strDate = `0${time.getDate()}`.slice(-2);
                dataArr.push(`${month}-${strDate}`);
            }

            brokenOption.xAxis.data = dataArr;
            myChart.setOption(brokenOption);
        }

        /**
         * 人员类别数据统计
         */
        function getPersonType() {
            $.ajax({
                url: "http://nhmsfz.nhgaj.com/func/personTypeStatistic/getPersonType",
                type: "get",
                dataType: "json",
                success: function (r) {
                    cpieOption.series[0].data = r.data;
                    myChart2.setOption(cpieOption);
                },
                error: function (data) {
                    alert(JSON.stringify(data));
                }
            });
        }
    });
</script>

</body>
</html>